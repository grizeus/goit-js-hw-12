{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.ts","../src/js/render-functions.ts","../src/main.ts"],"sourcesContent":["import axios from \"axios\";\n\nconst API_KEY = \"34523545-f21683fd59bfc3e4e2549fe07\";\nconst BASE_URL = \"https://pixabay.com/api\";\n\naxios.defaults.baseURL = BASE_URL;\n\nexport default async function fetchFrom(query: string, perPage?: number, curPage = 1) {\n  // set default perPage if not provided\n  if (perPage === undefined || perPage === null || perPage < 1) {\n    perPage = 15;\n  }\n\n  const params = {\n    key: API_KEY,\n    q: query,\n    image_type: \"photo\",\n    orientation: \"horizontal\",\n    safesearch: \"true\",\n    per_page: perPage,\n    page: curPage,\n  };\n\n  return axios.get(\"/\", { params });\n}\n","interface Picture {\n  webformatURL: string;\n  largeImageURL: string;\n  tags: string[];\n  likes: number;\n  views: number;\n  comments: number;\n  downloads: number;\n}\n\ninterface FetchData {\n  hits: Picture[];\n}\n\nexport default function renderGallery(fetchData: FetchData) {\n  const galleryMarkup = fetchData.hits\n    .map((picture: Picture) => {\n      const {\n        webformatURL,\n        largeImageURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      } = picture;\n      return `\n        <li class=\"gallery-item\">\n            <a href=\"${largeImageURL}\" target=\"_blank\">\n                <div class=\"img-wrapper\">\n                  <img class=\"gallery-image\" src=\"${webformatURL}\" alt=\"${tags}\" />\n                </div>\n            </a>\n            <ul class=\"gallery-item-info\">\n                <li class=\"gallery-item-likes\"><b>Likes</b> ${likes}</li>\n                <li class=\"gallery-item-views\"><b>Views</b> ${views}</li>\n                <li class=\"gallery-item-comments\"><b>Comments</b> ${comments}</li>\n                <li class=\"gallery-item-downloads\"><b>Downloads</b> ${downloads}</li>\n            </ul>\n        </li>\n        `;\n    })\n    .join(\"\");\n\n  return galleryMarkup;\n}\n","import fetchFrom from \"./js/pixabay-api.js\";\nimport renderGallery from \"./js/render-functions.js\";\nimport iziToast, { IziToastSettings } from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\nimport \"./css/custom-izitoast.css\";\nimport simpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\nimport \"./css/custom-slb.css\";\n\nconst searchInput = document.querySelector(\".search-input\") as HTMLInputElement;\nconst searchButton = document.querySelector(\".search-btn\") as HTMLButtonElement;\nconst loadMoreButton = document.querySelector(\".load-btn\") as HTMLButtonElement;\nconst topLoader= document.querySelector(\".in-loader\") as HTMLSpanElement;\nconst moreLoader = document.querySelector(\".more-loader\") as HTMLSpanElement;\nconst gallery = document.querySelector(\"ul.gallery-list\") as HTMLUListElement;\n\nlet curPage: number = 1;\nlet maxPages: number = 0;\nconst perPage: number = 15;\nlet searchQuery: string = \"\";\nlet galleryCardHeight: number = 0;\nconst errSvg: string = \"./img/error.svg\";\n\nconst TOAST_CONFIG: IziToastSettings = {\n  titleSize: \"16px\",\n  maxWidth: 432,\n  position: \"topRight\",\n  closeOnEscape: true,\n  icon: \"error\",\n  iconUrl: errSvg,\n  theme: \"dark\",\n};\n\nconst lightbox: simpleLightbox = new simpleLightbox(\".gallery-list a\", {\n  captionsData: \"alt\",\n  captionDelay: 250,\n});\n\nsearchButton?.addEventListener(\"click\", async e => {\n  e.preventDefault();\n\n  searchQuery = searchInput?.value.trim() ?? \"\";\n\n  if (searchQuery === \"\") {\n    gallery.innerHTML = \"\";\n    loadMoreButton.classList.add(\"visually-hidden\");\n    return;\n  }\n\n  gallery.innerHTML = \"\";\n  topLoader.classList.toggle(\"visually-hidden\");\n  curPage = 1;\n\n  try {\n    const { data } = await fetchFrom(searchQuery, perPage, curPage);\n\n    // remove load more button if backend returns empty array\n    if (!data.hits.length) {\n      if (!loadMoreButton.classList.contains(\"visually-hidden\")) {\n        loadMoreButton.classList.add(\"visually-hidden\");\n      }\n    }\n\n    if (!data.totalHits) {\n      gallery.innerHTML = \"\";\n      topLoader.classList.add(\"visually-hidden\");\n      iziToast.error({\n        ...TOAST_CONFIG,\n        message:\n          \"Sorry, there are no images matching your search query. Please try again!\",\n      });\n      return;\n    }\n\n    gallery.insertAdjacentHTML(\"beforeend\", renderGallery(data));\n    topLoader.classList.add(\"visually-hidden\");\n    loadMoreButton.classList.remove(\"visually-hidden\");\n\n    if (data.totalHits < perPage) {\n      loadMoreButton.classList.add(\"visually-hidden\");\n      iziToast.info({\n        position: \"topRight\",\n        message: \"We're sorry, but you've reached the end of search results.\",\n      });\n    }\n    maxPages = Math.ceil(data.totalHits / perPage);\n    lightbox.refresh();\n  } catch (error) {\n    console.error(error);\n    return;\n  }\n});\n\nloadMoreButton.addEventListener(\"click\", async e => {\n  e.preventDefault();\n\n  moreLoader.classList.remove(\"visually-hidden\");\n  loadMoreButton.classList.add(\"visually-hidden\");\n\n  try {\n    const { data } = await fetchFrom(searchQuery, perPage, ++curPage);\n    gallery.insertAdjacentHTML(\"beforeend\", renderGallery(data));\n\n    moreLoader.classList.add(\"visually-hidden\");\n    loadMoreButton.classList.remove(\"visually-hidden\");\n    lightbox.refresh();\n    if (galleryCardHeight === 0) {\n      galleryCardHeight = document\n        .querySelector(\".gallery-item\")?.getBoundingClientRect().height ?? 0;\n    }\n\n    window.scrollBy({\n      top: galleryCardHeight * 2,\n      behavior: \"smooth\",\n    });\n\n    if (maxPages === curPage) {\n      loadMoreButton.classList.add(\"visually-hidden\");\n      iziToast.info({\n        position: \"topRight\",\n        message: \"We're sorry, but you've reached the end of search results.\",\n      });\n    }\n  } catch (error) {\n    console.error(error);\n  }\n});\n"],"names":["API_KEY","BASE_URL","axios","fetchFrom","query","perPage","curPage","params","renderGallery","fetchData","picture","webformatURL","largeImageURL","tags","likes","views","comments","downloads","searchInput","searchButton","loadMoreButton","topLoader","moreLoader","gallery","maxPages","searchQuery","galleryCardHeight","errSvg","TOAST_CONFIG","lightbox","simpleLightbox","e","data","iziToast","error","_a"],"mappings":"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"}