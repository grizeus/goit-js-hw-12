{"version":3,"file":"commonHelpers.js","sources":["../src/ts/pixabay-api.ts","../src/ts/render.ts","../src/img/error.svg","../src/ts/helpers.ts","../src/main.ts"],"sourcesContent":["import axios, { AxiosResponse } from \"axios\";\n\nexport const API_KEY = \"34523545-f21683fd59bfc3e4e2549fe07\";\nexport const BASE_URL = \"https://pixabay.com/api\";\n\naxios.defaults.baseURL = BASE_URL;\n\nexport default async function fetchFrom(\n  query: string,\n  perPage?: number,\n  curPage = 1\n): Promise<AxiosResponse> {\n  // set default perPage if not provided\n  if (perPage === undefined || perPage === null || perPage < 1) {\n    perPage = 15;\n  }\n\n  const params = {\n    key: API_KEY,\n    q: query,\n    image_type: \"photo\",\n    orientation: \"horizontal\",\n    safesearch: \"true\",\n    per_page: perPage,\n    page: curPage,\n  };\n\n  return await axios.get(\"/\", { params });\n}\n","import he from \"he\";\n\nexport interface Picture {\n  webformatURL: string;\n  largeImageURL: string;\n  tags: string;\n  likes: number | undefined;\n  comments: number | undefined;\n  views: number;\n  downloads: number;\n}\n\ninterface FetchData {\n  hits: Picture[];\n}\n\nexport default function renderGallery(fetchData: FetchData) {\n  const galleryMarkup = fetchData.hits\n    .map((picture: Picture) => {\n      const {\n        webformatURL,\n        largeImageURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      } = picture;\n\n      return `\n        <li class=\"gallery-item\">\n            <a href=\"${he.escape(largeImageURL)}\" target=\"_blank\">\n                <div class=\"img-wrapper\">\n                  <img class=\"gallery-image\" src=\"${he.escape(webformatURL)}\" alt=\"${he.escape(tags)}\" />\n                </div>\n            </a>\n            <ul class=\"gallery-item-info\">\n                <li class=\"gallery-item-likes\"><b>Likes</b> ${likes}</li>\n                <li class=\"gallery-item-views\"><b>Views</b> ${views}</li>\n                <li class=\"gallery-item-comments\"><b>Comments</b> ${comments}</li>\n                <li class=\"gallery-item-downloads\"><b>Downloads</b> ${downloads}</li>\n            </ul>\n        </li>\n        `;\n    })\n    .join(\"\");\n\n  return galleryMarkup;\n}","export default \"data:image/svg+xml,%3csvg%20version='1.1'%20xmlns='http://www.w3.org/2000/svg'%20width='32'%20height='32'%20viewBox='0%200%2032%2032'%3e%3cpath%20fill='%23fff'%20d='M9.080%200.292c0.187-0.187%200.441-0.292%200.706-0.292h12.428c0.265%200%200.519%200.105%200.706%200.292l8.788%208.788c0.187%200.187%200.292%200.441%200.292%200.706v12.428c0%200.265-0.105%200.519-0.292%200.706l-8.788%208.788c-0.187%200.187-0.441%200.292-0.706%200.292h-12.428c-0.265%200-0.519-0.105-0.706-0.292l-8.788-8.788c-0.187-0.187-0.292-0.441-0.292-0.706v-12.428c0-0.265%200.105-0.519%200.292-0.706l8.788-8.788zM10.2%202l-8.2%208.2v11.6l8.2%208.2h11.6l8.2-8.2v-11.6l-8.2-8.2h-11.6z'%3e%3c/path%3e%3cpath%20fill='%23fff'%20d='M9.292%209.292c0.093-0.093%200.203-0.167%200.325-0.217s0.252-0.076%200.383-0.076c0.132%200%200.262%200.026%200.383%200.076s0.232%200.124%200.325%200.217l5.292%205.294%205.292-5.294c0.093-0.093%200.203-0.167%200.325-0.217s0.252-0.076%200.383-0.076c0.131%200%200.262%200.026%200.383%200.076s0.232%200.124%200.325%200.217c0.093%200.093%200.167%200.203%200.217%200.325s0.076%200.252%200.076%200.383-0.026%200.262-0.076%200.383c-0.050%200.121-0.124%200.232-0.217%200.325l-5.294%205.292%205.294%205.292c0.093%200.093%200.167%200.203%200.217%200.325s0.076%200.252%200.076%200.383-0.026%200.262-0.076%200.383c-0.050%200.121-0.124%200.232-0.217%200.325s-0.203%200.167-0.325%200.217c-0.121%200.050-0.252%200.076-0.383%200.076s-0.262-0.026-0.383-0.076c-0.121-0.050-0.232-0.124-0.325-0.217l-5.292-5.294-5.292%205.294c-0.093%200.093-0.203%200.167-0.325%200.217s-0.252%200.076-0.383%200.076-0.262-0.026-0.383-0.076c-0.121-0.050-0.232-0.124-0.325-0.217s-0.167-0.203-0.217-0.325c-0.050-0.121-0.076-0.252-0.076-0.383s0.026-0.262%200.076-0.383c0.050-0.121%200.124-0.232%200.217-0.325l5.294-5.292-5.294-5.292c-0.093-0.093-0.167-0.203-0.217-0.325s-0.076-0.252-0.076-0.383c0-0.132%200.026-0.262%200.076-0.383s0.124-0.232%200.217-0.325z'%3e%3c/path%3e%3c/svg%3e\"","import iziToast, { IziToastSettings } from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\nimport \"../css/custom-izitoast.css\";\nimport { AxiosError } from \"axios\";\nimport errSvg from \"../img/error.svg\";\n\nexport const TOAST_CONFIG: IziToastSettings = {\n  titleSize: \"16px\",\n  maxWidth: 432,\n  position: \"topRight\",\n  closeOnEscape: true,\n  theme: \"dark\",\n};\n\nexport const ERR_TOAST_CONFIG: IziToastSettings = {\n  ...TOAST_CONFIG,\n  icon: \"error\",\n  iconUrl: errSvg,\n};\n\nexport function handleEmptyResponse(\n  data: any,\n  gallery: HTMLElement,\n  topLoader: HTMLElement,\n  loadMoreButton: HTMLButtonElement,\n  moreLoader: HTMLElement\n): boolean {\n  if (!data.hits.length) {\n    gallery.innerHTML = \"\";\n    removeVisibility(topLoader);\n    removeVisibility(loadMoreButton);\n    removeVisibility(moreLoader);\n    iziToast.error({\n      ...ERR_TOAST_CONFIG,\n      message:\n        \"Sorry, there are no images matching your search query. Please try again!\",\n    });\n    return false;\n  }\n\n  return true;\n}\n\nexport function validateSearchQuery(\n  query: string,\n  gallery: HTMLUListElement,\n  loadBtn: HTMLButtonElement,\n  topLoader: HTMLSpanElement\n): boolean {\n  if (query === \"\") {\n    gallery.innerHTML = \"\";\n    removeVisibility(loadBtn);\n    return false;\n  }\n\n  gallery.innerHTML = \"\";\n  addVisibility(topLoader);\n\n  return true;\n}\n\nexport function addVisibility(element: HTMLElement): void {\n  if (element.classList.contains(\"visually-hidden\")) {\n    element.classList.remove(\"visually-hidden\");\n  } else {\n    return;\n  }\n}\n\nexport function removeVisibility(element: HTMLElement): void {\n  if (!element.classList.contains(\"visually-hidden\")) {\n    element.classList.add(\"visually-hidden\");\n  } else {\n    return;\n  }\n}\n\nexport function handleError(\n  error: unknown,\n  loadMoreButton: HTMLButtonElement,\n  topLoader: HTMLSpanElement,\n  moreLoader: HTMLSpanElement\n): void {\n  removeVisibility(loadMoreButton);\n  removeVisibility(topLoader);\n  removeVisibility(moreLoader);\n\n  if (error instanceof AxiosError) {\n    console.error(\"Axios Error:\", error.message);\n    console.error(\"Error Details:\", error.config);\n    iziToast.error({\n      ...ERR_TOAST_CONFIG,\n      message: `Sorry, error occurred: ${error.message}. Please try again!`,\n    });\n  } else {\n    console.error(error);\n    iziToast.error({\n      ...ERR_TOAST_CONFIG,\n      message: \"Sorry, unexpected error occurred. Please try again!\",\n    });\n  }\n}\n\nexport function scrollBy(galleryCardHeight: number): void {\n  if (galleryCardHeight === 0) {\n    galleryCardHeight =\n      document.querySelector(\".gallery-item\")?.getBoundingClientRect().height ??\n      0;\n  }\n\n  window.scrollBy({\n    top: galleryCardHeight * 2,\n    behavior: \"smooth\",\n  });\n}\n","import fetchFrom from \"./ts/pixabay-api.ts\";\nimport renderGallery from \"./ts/render.ts\";\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\nimport \"./css/custom-izitoast.css\";\nimport simpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\nimport \"./css/custom-slb.css\";\nimport {\n  TOAST_CONFIG,\n  handleEmptyResponse,\n  validateSearchQuery,\n  addVisibility,\n  removeVisibility,\n  handleError,\n  scrollBy,\n} from \"./ts/helpers.ts\";\n\nconst searchInput = document.querySelector(\".search-input\") as HTMLInputElement;\nconst searchButton = document.querySelector(\".search-btn\") as HTMLButtonElement;\nconst loadMoreButton = document.querySelector(\".load-btn\") as HTMLButtonElement;\nconst topLoader = document.querySelector(\".in-loader\") as HTMLSpanElement;\nconst moreLoader = document.querySelector(\".more-loader\") as HTMLSpanElement;\nconst gallery = document.querySelector(\"ul.gallery-list\") as HTMLUListElement;\n\nlet curPage: number = 1;\nlet maxPages: number = 0;\nconst perPage: number = 15;\nlet searchQuery: string = \"\";\nlet galleryCardHeight: number = 0;\n\nconst lightbox: simpleLightbox = new simpleLightbox(\".gallery-list a\", {\n  captionsData: \"alt\",\n  captionDelay: 250,\n});\n\nsearchButton.addEventListener(\"click\", async e => {\n  e.preventDefault();\n\n  searchQuery = searchInput?.value.trim() ?? \"\";\n  if (!validateSearchQuery(searchQuery, gallery, loadMoreButton, topLoader)) {\n    return;\n  }\n  curPage = 1;\n\n  try {\n    const { data } = await fetchFrom(searchQuery, perPage, curPage);\n    \n    if (!handleEmptyResponse(data, gallery, topLoader, loadMoreButton, moreLoader)) {\n      return;\n    }\n\n    gallery.insertAdjacentHTML(\"beforeend\", renderGallery(data));\n    removeVisibility(topLoader);\n    addVisibility(loadMoreButton);\n\n    if (data.totalHits && data.totalHits < perPage) {\n      removeVisibility(loadMoreButton);\n      iziToast.info({\n        ...TOAST_CONFIG,\n        message: \"We're sorry, but you've reached the end of search results.\",\n      });\n    }\n    maxPages = Math.ceil(data.totalHits / perPage);\n    lightbox.refresh();\n  } catch (error) {\n    handleError(error, loadMoreButton, topLoader, moreLoader);\n  }\n});\n\nloadMoreButton.addEventListener(\"click\", async e => {\n  e.preventDefault();\n\n  addVisibility(moreLoader);\n  removeVisibility(loadMoreButton);\n\n  try {\n    const { data } = await fetchFrom(searchQuery, perPage, ++curPage);\n\n    handleEmptyResponse(data, gallery, topLoader, loadMoreButton, moreLoader);\n\n    gallery.insertAdjacentHTML(\"beforeend\", renderGallery(data));\n\n    removeVisibility(moreLoader);\n    addVisibility(loadMoreButton);\n\n    lightbox.refresh();\n\n    scrollBy(galleryCardHeight);\n\n    if (maxPages === curPage) {\n      removeVisibility(loadMoreButton);\n      iziToast.info({\n        ...TOAST_CONFIG,\n        message: \"We're sorry, but you've reached the end of search results.\",\n      });\n    }\n  } catch (error: any) {\n    handleError(error, loadMoreButton, topLoader, moreLoader);\n  }\n});\n"],"names":["API_KEY","BASE_URL","axios","fetchFrom","query","perPage","curPage","params","renderGallery","fetchData","picture","webformatURL","largeImageURL","tags","likes","views","comments","downloads","he","errSvg","TOAST_CONFIG","ERR_TOAST_CONFIG","handleEmptyResponse","data","gallery","topLoader","loadMoreButton","moreLoader","removeVisibility","iziToast","validateSearchQuery","loadBtn","addVisibility","element","handleError","error","AxiosError","scrollBy","galleryCardHeight","_a","searchInput","searchButton","maxPages","searchQuery","lightbox","simpleLightbox","e"],"mappings":"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"}